###
 * This file is part of the Konsserto package.
 *
 * (c) Jessym Reziga <jessym@konsserto.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
###

Table = use('cli-table');

Command = use('@Konsserto/Component/Console/Command')
InputArgument = use('@Konsserto/Component/Console/Input/InputArgument')
InputOption = use('@Konsserto/Component/Console/Input/InputOption')
Tools = use('@Konsserto/Component/Static/Tools');

#
# ListCommand lists all commands
#
# @author Jessym Reziga <jessym@konsserto.com>
#
class ListCommand extends Command


	create:() ->
		@setName('list')
		@setDescription('List all commands')
		@setDefinition()
		@setHelp('  The %command.name% command lists all commands:\n  %command.full_name%')

	execute:(input) ->
		commands = Tools.sortObject(@getApplication().getCommands())
		@nl()
		@write('Options :')
		table = new Table({head: ['Option', 'Description'],chars:@getArrayChars()});

		for k,option of @getApplication().getDefaultInputDefinition().getOptions()
			table.push(['--'+option.getName()+' ['+option.getShortcut()+']',option.getDescription()])

		@write(table.toString())
		@write('\nCommands :')
		table = new Table({head: ['Command name', 'Description'],chars:@getArrayChars()});

		limit = 55
		for name,command of commands
			desc = if command.getDescription().length > limit then command.getDescription().substr(0,limit)+'...' else command.getDescription()
			table.push([name,desc])

		@write(table.toString())



module.exports = ListCommand;