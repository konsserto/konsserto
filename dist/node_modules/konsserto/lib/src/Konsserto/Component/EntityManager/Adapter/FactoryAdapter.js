var CONFIG, FactoryAdapter, cc;

CONFIG = use('/app/config/config');

cc = use('cli-color');

FactoryAdapter = (function() {
  function FactoryAdapter() {}

  FactoryAdapter.getInstance = function() {
    var adapter;
    adapter = void 0;
    if (FactoryAdapter.isConfigDbOk()) {
      if (CONFIG.database.driver === 'mysql') {
        adapter = use('@Konsserto/Component/EntityManager/Adapter/MysqlAdapter').getInstance();
      } else {
        if (CONFIG.database.driver === 'mongodb') {
          adapter = use('@Konsserto/Component/EntityManager/Adapter/MongodbAdapter').getInstance();
        }
      }
    }
    return adapter;
  };

  FactoryAdapter.isConfigDbOk = function() {
    if (CONFIG.database) {
      if (!CONFIG.database.host) {
        console.log(cc.red('[ERROR DATABASE] Missing Host'));
        return false;
      }
      if (!CONFIG.database.port) {
        console.log(cc.red('[ERROR DATABASE] Missing port'));
        return false;
      }
      if (!CONFIG.database.name) {
        console.log(cc.red('[ERROR DATABASE] Missing database name'));
        return false;
      }
      if (!CONFIG.database.user) {
        console.log(cc.red('[ERROR DATABASE] Missing database user'));
        return false;
      }
      return true;
    }
    return false;
  };

  return FactoryAdapter;

})();

module.exports = FactoryAdapter;
